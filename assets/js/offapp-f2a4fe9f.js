var t=Object.defineProperty,e=(e,i,s)=>(((e,i,s)=>{i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[i]=s})(e,"symbol"!=typeof i?i+"":i,s),s);import{d as i,v as s,o as n,a as r,g as o,e as a,K as h,n as l,k as d,B as c,F as u,h as g,i as p,G as m,X as f}from"./store-a24b3c16.js";import{_ as y,T as v,I as w,E as x,M as _}from"./plugin-vue_export-helper-aebdfa9d.js";const S=class{constructor(){e(this,"name"),e(this,"node"),e(this,"_visible",!0),e(this,"pivotX",0),e(this,"pivotY",0),e(this,"childlist",[]),e(this,"_rotation",0),e(this,"_changeTransform",!1),e(this,"attrKeys",{}),e(this,"_transform")}addChild(t){if(t==this)return;-1==this.childlist.indexOf(t)&&this.childlist.push(t)}removeChild(t){let e=this.childlist.indexOf(t);-1!=e&&this.childlist.splice(e,1)}removeAllChild(){this.childlist.length=0}set rotation(t){if(this._rotation!=t){this._rotation=t,this._changeTransform=!0;for(let e=0;e<this.childlist.length;e++){this.childlist[e].rotation=t}}}get rotation(){return this._rotation}startRotation(){}endRotation(){}applyTransform(){1==this._changeTransform&&(this._changeTransform=!1,0!=this._rotation?(this._transform="",this._transform+=` translate(${this.pivotX} ${this.pivotY})`,this._transform+=` rotate(${this._rotation})`,this._transform+=` translate(${-this.pivotX} ${-this.pivotY})`,this.setAttribute("transform",this._transform)):this.setAttribute("transform",""))}get transformInfo(){return this._transform}setPivot(t,e){this.pivotX=Math.ceil(100*t)/100,this.pivotY=Math.ceil(100*e)/100,this._changeTransform=!0;for(let i=0;i<this.childlist.length;i++){this.childlist[i].setPivot(t,e)}}setAttribute(t,e,i){if(1!=i||!isNaN(e)){if(void 0===e)return this.node.getAttribute(t);this.node.setAttribute(t,e),this.attrKeys[t]=t}}getAttribute(t){return this.node.getAttribute(t)}set visible(t){this._visible!=t&&(this._visible=t,this.node.style.display=1==t?"block":"none")}get visible(){return this._visible}noZero(t){return(t<=0||isNaN(t))&&(t=1e-5),t}localToWorld(t,e){var i=this.node.getScreenCTM();return null==S._tempPoint&&(S._tempPoint=new DOMPoint),S._tempPoint.x=t,S._tempPoint.y=e,S._tempPoint.matrixTransform(i)}worldToLocal(t,e){var i=this.node.getScreenCTM();return null==S._tempPoint&&(S._tempPoint=new DOMPoint),S._tempPoint.x=t,S._tempPoint.y=e,S._tempPoint.matrixTransform(i.inverse())}localToWorldDelta(t,e){var i=this.node.getScreenCTM();null==S._tempPoint&&(S._tempPoint=new DOMPoint),S._tempPoint.x=t,S._tempPoint.y=e;let s=i;return s=new DOMMatrix([s.a,s.b,s.c,s.d,0,0]),S._tempPoint.matrixTransform(s)}worldToLocalDelta(t,e){var i=this.node.getScreenCTM();null==S._tempPoint&&(S._tempPoint=new DOMPoint),S._tempPoint.x=t,S._tempPoint.y=e;let s=i.inverse();return s=new DOMMatrix([s.a,s.b,s.c,s.d,0,0]),S._tempPoint.matrixTransform(s)}draw(t){if(1==t)for(let e=0;e<this.childlist.length;e++){this.childlist[e].draw(t)}}clear(t){if(1==t)for(let e=0;e<this.childlist.length;e++){this.childlist[e].clear(t)}}reset(t){if(this.pivotX=0,this.pivotY=0,this._rotation=0,this._transform="",this.attrKeys={},1==t)for(let e=0;e<this.childlist.length;e++){this.childlist[e].reset(t)}}release(){this.reset(),this.node=null}};let C=S;e(C,"_tempPoint");class L extends C{constructor(t){super(),e(this,"_x",0),e(this,"_y",0),e(this,"_changedPos",!0),e(this,"_radius",0),e(this,"_changedSize",!0),e(this,"offset",0),null!=t?(this.node=t,this.name=t.id,this.x=Number(this.getAttribute("cx")),this.y=Number(this.getAttribute("cy")),this._radius=Number(this.getAttribute("r"))):this.node=document.createElementNS("http://www.w3.org/2000/svg","rect")}move(t,e){Array.isArray(t)?(this.x=t[0],this.y=t[1]):(this.x=t,this.y=e)}circle(t,e,i){this.x=t,this.y=e,this.radius=i}set x(t){this._x!=t&&(this._x=t,this._changedPos=!0)}get x(){return this._x}set y(t){this._y!=t&&(this._y=t,this._changedPos=!0)}get y(){return this._y}set radius(t){t=Math.max(t,0),this._radius!=t&&(this._radius=t,this._changedSize=!0)}get width(){return this._radius}draw(t){if(1==this._changedPos&&(this._changedPos=!1,this.setAttribute("cx",this._x+this.offset,!0),this.setAttribute("cy",this._y+this.offset,!0)),1==this._changedSize&&(this._changedSize=!1,this.setAttribute("r",this._radius,!0)),this.applyTransform(),1==t)for(let e=0;e<this.childlist.length;e++){this.childlist[e].draw(t)}}clear(t){if(1==t)for(let e=0;e<this.childlist.length;e++){this.childlist[e].clear(t)}}reset(t){if(this._x=0,this._y=0,super.reset(),1==t)for(let e=0;e<this.childlist.length;e++){this.childlist[e].reset(t)}}}class T extends C{constructor(t){super(),e(this,"_x",0),e(this,"_y",0),e(this,"_changedPos",!0),e(this,"_width",0),e(this,"_height",0),e(this,"_changedSize",!0),e(this,"offset",0),null!=t?(this.node=t,this.name=t.id,this.x=Number(this.getAttribute("x")),this.y=Number(this.getAttribute("x"))):this.node=document.createElementNS("http://www.w3.org/2000/svg","image")}move(t,e){Array.isArray(t)?(this.x=t[0],this.y=t[1]):(this.x=t,this.y=e)}set x(t){this._x!=t&&(this._x=t+this.offset,this._changedPos=!0)}get x(){return this._x}set y(t){this._y!=t&&(this._y=t+this.offset,this._changedPos=!0)}get y(){return this._y}set width(t){this._width!=t&&(this._width=t,this._changedSize=!0)}get width(){return this._width}set height(t){this._height!=t&&(this._height=t,this._changedSize=!0)}get height(){return this._height}draw(t){if(1==this._changedPos&&(this._changedPos=!1,this.setAttribute("x",this._x,!0),this.setAttribute("y",this._y,!0)),1==this._changedSize&&(this._changedSize=!1,this.setAttribute("width",this.noZero(this._width),!0),this.setAttribute("height",this.noZero(this._height),!0)),this.applyTransform(),1==t)for(let e=0;e<this.childlist.length;e++){this.childlist[e].draw(t)}}clear(t){if(1==t)for(let e=0;e<this.childlist.length;e++){this.childlist[e].clear(t)}}reset(t){if(this._x=0,this._y=0,super.reset(),1==t)for(let e=0;e<this.childlist.length;e++){this.childlist[e].reset(t)}}}class b extends C{constructor(t){super(),e(this,"pointList",[]),e(this,"_changed",!0),e(this,"cacheData",""),null!=t?(this.node=t,this.name=t.id):this.node=document.createElementNS("http://www.w3.org/2000/svg","polygon")}buildPoints(){if(1==this._changed){this._changed=!1;let s=this.pointList;for(var t=[],e=0,i=s.length;e<i;e++){let i=s[e];t.push(i.join(","))}this.cacheData=t.join(" ")}return this.cacheData}getPoint(t){return this.pointList[t]}setPoint(t,e,i){this.pointList[t]=[e,i],this._changed=!0}push(t,e){this.pointList.push([t,e]),this._changed=!0}rect(t,e,i,s){this.pointList.length=0,this.pointList.push([t,e]),this.pointList.push([t+i,e]),this.pointList.push([t+i,e+s]),this.pointList.push([t,e+s]),this.pointList.push([t,e]),this._changed=!0}points(...t){for(var e=0,i=t.length;e<i;e+=2){let i=t[e],s=t[e+1];this.pointList.push([i,s]),this._changed=!0}}draw(t){if(this.setAttribute("points",this.buildPoints()),this.applyTransform(),1==t)for(let e=0;e<this.childlist.length;e++){this.childlist[e].draw(t)}}clear(t){if(this.pointList.length=0,1==t)for(let e=0;e<this.childlist.length;e++){this.childlist[e].clear(t)}}reset(t){if(this.pointList.length=0,this.cacheData="",super.reset(),1==t)for(let e=0;e<this.childlist.length;e++){this.childlist[e].reset(t)}}}class M extends C{constructor(t){super(),e(this,"_x",0),e(this,"_y",0),e(this,"_changedPos",!0),e(this,"_width",0),e(this,"_height",0),e(this,"_changedSize",!0),e(this,"_changeWorld",!1),e(this,"offset",0),null!=t?(this.node=t,this.name=t.id,this.x=Number(this.getAttribute("x")),this.y=Number(this.getAttribute("y")),this.width=Number(this.getAttribute("width")),this.height=Number(this.getAttribute("height"))):this.node=document.createElementNS("http://www.w3.org/2000/svg","rect")}move(t,e){Array.isArray(t)?(this.x=t[0],this.y=t[1]):(this.x=t,this.y=e)}rect(t,e,i,s){this.x=t,this.y=e,this.width=i,this.height=s}set size(t){this.width=t,this.height=t}set x(t){this._x!=t&&(this._x=t,this._changedPos=!0,this._changeWorld=!0)}get x(){return this._x}set y(t){this._y!=t&&(this._y=t,this._changedPos=!0,this._changeWorld=!0)}get y(){return this._y}set width(t){this._width!=t&&(this._width=t,this._changedSize=!0)}get width(){return this._width}set height(t){this._height!=t&&(this._height=t,this._changedSize=!0)}get height(){return this._height}isContainPoint(t,e,i=0){return t>=this._x-i&&t<=this._x+this._width+i&&e>=this._y-i&&e<=this._y+this._height+i}draw(t){if(1==this._changedPos&&(this._changedPos=!1,this.setAttribute("x",this._x+this.offset,!0),this.setAttribute("y",this._y+this.offset,!0)),1==this._changedSize&&(this._changedSize=!1,this.setAttribute("width",this.noZero(this._width),!0),this.setAttribute("height",this.noZero(this._height),!0)),this.applyTransform(),1==t)for(let e=0;e<this.childlist.length;e++){this.childlist[e].draw(t)}}clear(t){if(1==t)for(let e=0;e<this.childlist.length;e++){this.childlist[e].clear(t)}}reset(t){if(this._x=0,this._y=0,super.reset(),1==t)for(let e=0;e<this.childlist.length;e++){this.childlist[e].reset(t)}}}const E={class:"div-svg-container"},N=[h('<g style="" data-v-9ecb232d><polygon id="polygon" points="130.03381993454286,236.91406910718945 258.4253622931619,236.91406910718945 386.816904651781,236.91406910718945 386.816904651781,334.7206182927025 386.816904651781,432.52716747821546 258.4253622931619,432.52716747821546 130.03381993454286,432.52716747821546 130.03381993454286,334.7206182927025 130.03381993454286,236.91406910718945" fill="transparent" stroke-opacity="0.8" stroke-width="1" stroke="#00ffff" style="" data-v-9ecb232d></polygon><g style="" data-v-9ecb232d><g style="cursor:default;pointer-events:auto;" data-v-9ecb232d><rect id="move" width="200" height="200" fill-opacity="0.1" fill="#33ccff" stroke-opacity="0.4" stroke-width="1" stroke="#33ccff" x="80" y="80" data-v-9ecb232d></rect></g><g style="cursor:nwse-resize;pointer-events:auto;" data-v-9ecb232d><rect id="p0" width="6" height="6" fill="#00ffff" x="127" y="233" data-v-9ecb232d></rect></g><g style="cursor:nesw-resize;pointer-events:auto;" data-v-9ecb232d><rect id="p1" width="6" height="6" fill="#00ffff" x="383" y="233" data-v-9ecb232d></rect></g><g style="cursor:nwse-resize;pointer-events:auto;" data-v-9ecb232d><rect id="p2" width="6" height="6" fill="#00ffff" x="383" y="429" data-v-9ecb232d></rect></g><g style="cursor:nesw-resize;pointer-events:auto;" data-v-9ecb232d><rect id="p3" width="6" height="6" fill="#00ffff" x="127" y="429" data-v-9ecb232d></rect></g><g style="cursor:ns-resize;pointer-events:auto;" data-v-9ecb232d><rect id="side0" width="6" height="6" fill="#ffffff" x="255" y="233" data-v-9ecb232d></rect></g><g style="cursor:ew-resize;pointer-events:auto;" data-v-9ecb232d><rect id="side1" width="6" height="6" fill="#ffffff" x="383" y="331" data-v-9ecb232d></rect></g><g style="cursor:ns-resize;pointer-events:auto;" data-v-9ecb232d><rect id="side2" width="6" height="6" fill="#ffffff" x="255" y="429" data-v-9ecb232d></rect><image id="iconrota" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFyWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4wLWMwMDAgNzkuMTcxYzI3ZiwgMjAyMi8wOC8xNi0xODowMjo0MyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI0LjAgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAyMy0wMy0wMVQxMzoxMzo1MCswODowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMy0wMy0wMVQxMzoxMzo1MCswODowMCIgeG1wOk1vZGlmeURhdGU9IjIwMjMtMDMtMDFUMTM6MTM6NTArMDg6MDAiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzNiZjU2YmUtZDI3Zi02NjQ1LWE1MTYtYzUzNjAyZjE5MDllIiB4bXBNTTpEb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6ZDIwMWE0NzgtNmRiNi1jNTQ5LWJhMzQtNmFhNDZjNzc5YjkwIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6NTY3ZmExNTUtNGY3Yi03NjQ4LTkwOGEtNjU1NjFmNWI0NDQwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6NTY3ZmExNTUtNGY3Yi03NjQ4LTkwOGEtNjU1NjFmNWI0NDQwIiBzdEV2dDp3aGVuPSIyMDIzLTAzLTAxVDEzOjEzOjUwKzA4OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjQuMCAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjczYmY1NmJlLWQyN2YtNjY0NS1hNTE2LWM1MzYwMmYxOTA5ZSIgc3RFdnQ6d2hlbj0iMjAyMy0wMy0wMVQxMzoxMzo1MCswODowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDI0LjAgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PrHpN/kAAAKfSURBVDiNdVM9SyNRFL1ZN0HEItikDSiYBTEzhQgrUzoWYyGCjUwtphERCyEh/oGJhSAIQhDSpAkJAxJ2g8ZCkqCFBiSLHyA6RDIo5mGiQd8wZ6sZjO6e8nHPvefdc66HPiEQCMizs7NTg4ODP0dGRn709PTQxcXFn1qtVspkMr9M0/z9meMgGIlEtGKx2MJ/UCwWW5FIRCOi4BdyLBZLcc67CI+PjzBNs+uNc45YLJbqahKNRjWHbNs20uk0pqenIQgCwuEwJicnsbu7C6eGc45oNKoREVEoFJKr1aore319HePj49jY2EChUMDBwQE2NzchSRIWFxdhWRYAoFqttkKhkEzxeDzxUaKu6yiVSnh6egLnHJZlodlsolKpYHR0FNvb225tPB5PUD6fLwNAvV6HqqowDMOd8hGWZWFrawvhcBi2bTvDynR7e8ssy8L8/Dz6+vqwtLT0TweazSYWFhbg9XqxsrKCu7s73NzcsO9+v5/q9Toxxuj19ZUMwyDGGPn9/i6b+vv7qdFoEOecTk5OaGBggAAQHR0dlTudDq6urhAIBLCzs4PPdjo4Pj7G8PAwCoUCbNtGpVIpf7u8vCz19vbS0NAQzc3NUTqdpk6n8yVlLy8v5PV6KZPJkCRJ5PF4qFarlUhRFLndbrcAwDAMSJKEmZkZHB4e4vn5GYwx7O/vQ1EULC8vuwtst9stRVFkIiJKJpOaE6Lz83Osrq5ibGwMoihCFEVMTExgbW0N19fX7neSyaTmyhMEIZjL5VJOk/v7e5yenmJvbw/5fB5nZ2doNBouOZfLpQRB6L4HURSD2WxWA+Cm8u3tDe/v7x/32Mpms5ooil+OiYiIfD4fqaoq67qeeHh4KANgAJhpmmVd1xOqqso+n6+L8xeWBXFEAgX3OQAAAABJRU5ErkJggg==" x="0" y="0" height="16px" width="16px" data-v-9ecb232d></image></g><g style="cursor:ew-resize;pointer-events:auto;" data-v-9ecb232d><rect id="side3" width="6" height="6" fill="#ffffff" x="127" y="331" data-v-9ecb232d></rect></g><g style="cursor:pointer;pointer-events:auto;" data-v-9ecb232d><circle id="center" r="3" cx="257.5" cy="336" fill="#ffffff" stroke="#000000" data-v-9ecb232d></circle></g></g><g style="cursor:pointer;pointer-events:none;" data-v-9ecb232d><circle id="pivot" r="3" cx="257.5" cy="336" fill="#ffff00" stroke="#000000" stroke-width="2" data-v-9ecb232d></circle></g></g>',1)],P=y(i({__name:"RectControl",setup(t,{expose:e}){let i=s(),h={};const l=1;let d=l;const c=0,u=1;let g=c;n((()=>{h.root=i.value,h.doc=h.root.ownerDocument,h.polygon=new b(h.doc.getElementById("polygon")),h.p0=new M(h.doc.getElementById("p0")),h.p1=new M(h.doc.getElementById("p1")),h.p2=new M(h.doc.getElementById("p2")),h.p3=new M(h.doc.getElementById("p3")),h.move=new M(h.doc.getElementById("move")),h.pivot=new L(h.doc.getElementById("pivot")),h.side0=new M(h.doc.getElementById("side0")),h.side1=new M(h.doc.getElementById("side1")),h.side2=new M(h.doc.getElementById("side2")),h.side3=new M(h.doc.getElementById("side3")),h.center=new L(h.doc.getElementById("center")),h.iconrota=new T(h.doc.getElementById("iconrota")),h.polygon.addChild(h.p0),h.polygon.addChild(h.p1),h.polygon.addChild(h.p2),h.polygon.addChild(h.p3),h.polygon.addChild(h.move),h.polygon.addChild(h.pivot),h.polygon.addChild(h.side0),h.polygon.addChild(h.side1),h.polygon.addChild(h.side2),h.polygon.addChild(h.side3),h.polygon.addChild(h.center),h.polygon.addChild(h.iconrota),h.p0.size=8,h.p1.size=8,h.p2.size=8,h.p3.size=8,h.pivot.radius=8,h.center.radius=5,h.iconrota.width=16,h.iconrota.height=16,h.iconrota.offset=-8,_(),g=c,function(t){d=t,d==l&&(h.pivot.visible=!1)}(l),R(100,100,200,200,!0),I(.5,.5)})),r((()=>{})),e({showControl:x,hideControl:_,selectControl:function(t){if(m=t,null==m)return void _();let e=m.getPos(),i=m.getSize(),s=m.getScale(),n=m.getRota(),r=m.getAnchor(),o=m.getMouse();null!=t.render?(p.isPos=t.render.controlSet.isPos,p.isSize=t.render.controlSet.isSize,p.isScale=t.render.controlSet.isScale,p.isRota=t.render.controlSet.isRota):(p.isPos=!0,p.isSize=!0,p.isScale=!0,p.isRota=!0);h.iconrota.visible=p.isRota;let a=i.width*s.scaleX,l=i.height*s.scaleY;R(e.x,e.y,a,l,!1),I(r.anchorX,r.anchorY),h.polygon.rotation=n,h.polygon.setPivot(k.pivotX,k.pivotY),h.polygon.draw(!0),x(),isNaN(o.mouseX)||isNaN(o.mouseY)||P(h.move.node,o.mouseX,o.mouseY)}});let p={isPos:!0,isSize:!0,isScale:!0,isRota:!0},m=null;function f(t=!0){if(null==m)return;let e=h.move.x,i=h.move.y;if(t){let t=h.move.localToWorld(e,i);e=t.x,i=t.y}m.setPos(e,i)}function y(){if(null==m)return;let t=h.move.x,e=h.move.y,i=h.move.width,s=h.move.height;m.setSize(t,e,i,s)}function v(){if(null==m)return;let t=h.move.rotation;m.setRota(t)}function w(){null!=m&&m.setAnchor(k.anchorX,k.anchorY)}function x(){h.root.style.display="block"}function _(){h.root.style.display="none"}let S={};function C(t){P(t.target,t.clientX,t.clientY)}function P(t,e,i){if(S.target=null,S.isRotation=!1,S.isScale=!1,S.isMove=!1,S.downx=e,S.downy=i,t==h.p0.node||t==h.p1.node||t==h.p2.node||t==h.p3.node||t==h.pivot.node||t==h.move.node||t==h.side0.node||t==h.side1.node||t==h.side2.node||t==h.side3.node||t==h.center.node||t==h.iconrota.node){if(S.target=t,S.cursor=S.target.style.cursor,S.pointerEvents=S.target.style.pointerEvents,S.target.style.cursor="pointer",S.target.style.pointerEvents="none",t==h.move.node);else if(t==h.pivot.node);else if(g==c&&d==l){let e=null,i=null;t==h.p0.node?e=h.p2:t==h.p2.node?e=h.p0:t==h.p1.node?e=h.p3:t==h.p3.node?e=h.p1:t==h.side0.node?(e=h.side2,i=h.center):t==h.side2.node?(e=h.side0,i=h.center):t==h.side1.node?(e=h.side3,i=h.center):t==h.side3.node?(e=h.side1,i=h.center):(t==h.center.node||t==h.iconrota.node)&&(e=h.center),null!=e&&("left"==m.CenterType||null!=i&&(e=i),A(e.x,e.y),w(),h.pivot.visible=!0)}else if(g==u&&d==l){let e=null;t==h.p0.node?e=h.p0:t==h.p2.node?e=h.p2:t==h.p1.node?e=h.p1:t==h.p3.node?e=h.p3:t==h.side0.node?e=h.side0:t==h.side2.node?e=h.side2:t==h.side1.node?e=h.side1:t==h.side3.node?e=h.side3:(t==h.center.node||t==h.iconrota.node)&&(e=h.center),null!=e&&(A(e.x,e.y),h.pivot.visible=!0,w())}S.ox=h.move.x,S.oy=h.move.y,S.ow=h.move.width,S.oh=h.move.height,S.rotaAngle=h.move.rotation,S.oPivotX=h.move.pivotX,S.oPivotY=h.move.pivotY}switch(S.target){case h.move.node:if(1!=p.isPos)return;h.doc.onmousemove=t=>{z(t);let e=t.clientX-S.downx,i=t.clientY-S.downy;if(S.target&&(0!=e||0!=i)){1!=S.isMove&&(S.isMove=!0),R(S.ox+e,S.oy+i,h.move.width,h.move.height,!0);let t=S.oPivotX+e,s=S.oPivotY+i;h.polygon.setPivot(t,s),Y(),f()}};break;case h.pivot.node:if(1!=p.isPos)return;h.doc.onmousemove=t=>{z(t);let e=t.clientX-S.downx,i=t.clientY-S.downy;if(S.target&&(0!=e||0!=i)){let e=t.clientX,i=t.clientY,s=10;if(h.move.isContainPoint(e,i,s/2)){let t=!1,n=h.move.x+h.move.width/2,r=h.move.y+h.move.height/2;if(Math.abs(n-e)<s&&(e=n),Math.abs(r-i)<s&&(i=r),e==n&&i==r&&(t=!0),1!=t){let t=[h.p0,h.p1,h.p2,h.p3];for(let n=0;n<t.length;n++){const r=t[n];let o=r.x,a=r.y;if(Math.abs(o-e)<s&&(e=o),Math.abs(a-i)<s&&(i=a),e==o&&i==a)break}}}A(e,i),w()}}}if(g==c)switch(S.target){case h.p0.node:case h.p1.node:case h.p2.node:case h.p3.node:case h.side0.node:case h.side1.node:case h.side2.node:case h.side3.node:if(1!=p.isScale)return;h.doc.onmousemove=t=>{z(t);let e=t.clientX-S.downx,i=t.clientY-S.downy;if(S.target==h.side3.node&&(e=-e),S.target==h.side0.node&&(i=-i),S.target&&(0!=e||0!=i)){let t=h.move.worldToLocalDelta(e,i);e=t.x,i=t.y,S.target==h.side0.node||S.target==h.side2.node?e=0:S.target!=h.side1.node&&S.target!=h.side3.node||(i=0);let s=Math.abs(h.pivot.x-S.ox)/S.ow,n=Math.abs(h.pivot.y-S.oy)/S.oh,r=0,o=0,a=0,l=0,d=2;if(s<=.5){a=S.ow+e;let t=e*(d*s);r=S.ox-t,a+=t}else{e=-e;let t=e*d*(1-s);a=S.ow+t,r=S.ox-e,a+=e}if(n<=.5){l=S.oh+i;let t=i*(d*n);o=S.oy-t,l+=t}else{i=-i;let t=i*d*(1-n);l=S.oh+t,o=S.oy-i,l+=i}1!=S.isScale&&(S.isScale=!0),R(r,o,a,l,!0),function(){if(null==m)return;let t=m.getSize(),e=Math.ceil(h.move.width),i=Math.ceil(h.move.height),s=e/t.width,n=i/t.height;m.setScale(s,n,e,i)}(),f()}}}if(g==u)switch(S.target){case h.p0.node:case h.p1.node:case h.p2.node:case h.p3.node:case h.side0.node:case h.side1.node:case h.side2.node:case h.side3.node:case h.center.node:case h.iconrota.node:if(1!=p.isRota)return;h.doc.onmousemove=t=>{z(t);let e=t.clientX-S.downx,i=t.clientY-S.downy;if(S.target&&(0!=e||0!=i)){let t=S.rotaAngle+.3*(e+i);1!=S.isRotation&&(S.isRotation=!0,h.polygon.startRotation(),D(),y()),h.polygon.rotation=t,h.polygon.draw(!0),v()}}}else if(g==c)switch(S.target){case h.center.node:case h.iconrota.node:if(1!=p.isRota)return;h.doc.onmousemove=t=>{z(t);let e=t.clientX-S.downx,i=t.clientY-S.downy;if(S.target&&(0!=e||0!=i)){S.target==h.iconrota.node&&(e*=-1,i*=-1);let t=S.rotaAngle+.3*(e+i);1!=S.isRotation&&(S.isRotation=!0,h.polygon.startRotation(),D(),y()),h.polygon.rotation=t,h.polygon.draw(!0),v()}}}h.doc.onmouseup=()=>{h.doc.onmousemove=null,h.doc.onmouseup=null,null!=S.target&&(S.downx=-1,S.downy=-1,S.target.style.cursor=S.cursor,S.target.style.pointerEvents=S.pointerEvents,S.target=null,1==S.isRotation&&(S.isRotation=!1,h.polygon.endRotation()),1==S.isScale&&(S.isScale=!1)),d==l&&(h.pivot.visible=!1)}}function D(){let t=h.move.width*k.anchorX,e=h.move.height*k.anchorY,i=Math.ceil(h.move.x),s=Math.ceil(h.move.y),n=i+t,r=s+e,o=h.move.localToWorld(n,r);n=Math.ceil(o.x),r=Math.ceil(o.y),o=h.move.localToWorld(i,s);let a=o.x,l=o.y,d=n-Math.ceil(a+t),c=r-Math.ceil(l+e);return a=Math.ceil(a+d),l=Math.ceil(l+c),h.polygon.setPivot(n,r),R(a,l,h.move.width,h.move.height,!1),Y(),!0}function R(t,e,i,s,n){h.polygon.clear(),h.polygon.rect(t,e,i,s),h.move.rect(t,e,i,s);let r=[h.p0,h.p1,h.p2,h.p3];for(let c=0;c<r.length;c++){const t=r[c];t.offset=-t.width/2,t.move(h.polygon.getPoint(c))}let o=h.move.width/2,a=h.move.height/2;r=[h.side0,h.side1,h.side2,h.side3];let l=h.polygon.getPoint(0),d=r[0];d.offset=-d.width/2,d.move(l[0]+o,l[1]),l=h.polygon.getPoint(1),d=r[1],d.offset=-d.width/2,d.move(l[0],l[1]+a),l=h.polygon.getPoint(2),d=r[2],d.offset=-d.width/2,d.move(l[0]-o,l[1]),l=h.polygon.getPoint(3),d=r[3],d.offset=-d.width/2,d.move(l[0],l[1]-a),h.center.move(h.move.x+o,h.move.y+a),d=r[2],h.iconrota.move(d.x,d.y+30),1==n&&h.polygon.draw(!0)}let k={anchorX:0,anchorY:0,pivotX:0,pivotY:0};function A(t,e){k.pivotX=t,k.pivotY=e,k.anchorX=(t-h.move.x)/h.move.width,k.anchorY=(e-h.move.y)/h.move.height,k.anchorX=Math.round(100*k.anchorX)/100,k.anchorY=Math.round(100*k.anchorY)/100,h.pivot.move(k.pivotX,k.pivotY),h.pivot.draw()}function I(t,e){k.anchorX=t,k.anchorY=e,k.anchorX=Math.round(100*k.anchorX)/100,k.anchorY=Math.round(100*k.anchorY)/100,k.pivotX=h.move.x+h.move.width*k.anchorX,k.pivotY=h.move.y+h.move.height*k.anchorY,h.pivot.move(k.pivotX,k.pivotY),h.pivot.draw()}function Y(){k.pivotX=h.move.x+h.move.width*k.anchorX,k.pivotY=h.move.y+h.move.height*k.anchorY,h.pivot.move(k.pivotX,k.pivotY),h.pivot.draw()}function z(t){return t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),t.preventDefault&&t.preventDefault(),!1}return(t,e)=>(o(),a("div",E,[(o(),a("svg",{ref_key:"refControl",ref:i,xmlns:"http://www.w3.org/2000/svg",version:"1.1","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:svgjs":"http://svgjs.dev/svgjs",width:"100%",height:"100%",onMousedown:C},N,544))]))}}),[["__scopeId","data-v-9ecb232d"]]);class D{static initmainmessage(){let t=null==window?void 0:window.parent;null!=t&&(t.onmainmessage=(t,...e)=>{0!=this.dispatch.send(t,...e)||w.TF_UPDATE_TIMELINE})}static sendlibmessage(t,...e){var i;let s=null==(i=null==window?void 0:window.parent)?void 0:i.onlibmessage;s&&s(t,...e)}static sendTomodule(t,...e){this.dispatch.send(t,...e)}static on(t,e,i){this.dispatch.on(t,e,i)}static off(t,e,i){this.dispatch.off(t,e,i)}static clearAll(t){this.dispatch.clearAll(t)}static release(){this.dispatch.release()}}e(D,"dispatch",new v);class R{constructor(){e(this,"owner"),e(this,"render"),e(this,"CenterType","default"),e(this,"mouseX",0),e(this,"mouseY",0)}setOwner(t){this.owner=t}getMouse(){let t={mouseX:0,mouseY:0};return t.mouseX=this.mouseX,t.mouseY=this.mouseY,t}getPos(){return{x:0,y:0}}getSize(){return{width:0,height:0}}getScale(){return{scaleX:1,scaleY:1}}getRota(){return 0}getAnchor(){return{anchorX:0,anchorY:0}}setMouse(t,e){(t<=0||e<=0)&&(t=NaN,e=NaN),this.mouseX=t,this.mouseY=e}setPos(t,e){}setSize(t,e,i,s){}setScale(t,e,i,s){}setRota(t){}setAnchor(t,e){}callRender(t,e){null!=this.render&&this.render.onControlData(t,e)}}var k=(t=>(t.setPos="setPos",t.setSize="setSize",t.setScale="setScale",t.setRota="setRota",t))(k||{});class A extends R{constructor(){super()}setOwner(t){this.owner=t,this.owner instanceof Laya.Text?this.CenterType="left":this.CenterType="default"}getMouse(){let t={mouseX:0,mouseY:0};return 0!=this.mouseX&&0!=this.mouseY&&(t.mouseX=this.mouseX*this.stageScaleX,t.mouseY=this.mouseY*this.stageScaleY),t}getPos(){let t={x:0,y:0};return this.owner instanceof Laya.Sprite&&(t.x=Math.ceil(this.owner.x*this.stageScaleX),t.y=Math.ceil(this.owner.y*this.stageScaleY)),t}getSize(){let t={width:0,height:0};return this.owner instanceof Laya.Sprite&&(t.width=Math.ceil(this.owner.width*this.stageScaleX),t.height=Math.ceil(this.owner.height*this.stageScaleY)),t}getScale(){let t={scaleX:1,scaleY:1};return this.owner instanceof Laya.Sprite&&(t.scaleX=this.owner.scaleX,t.scaleY=this.owner.scaleY),t}getRota(){return this.owner instanceof Laya.Sprite?this.owner.rotation:0}getAnchor(){let t={anchorX:0,anchorY:0};return this.owner instanceof Laya.Sprite&&(t.anchorX=this.owner.anchorX,t.anchorY=this.owner.anchorY),t}setPos(t,e){t/=this.stageScaleX,e/=this.stageScaleY,this.owner instanceof Laya.Sprite&&(this.owner.anchorX=0,this.owner.anchorY=0,this.owner.x=Math.ceil(t),this.owner.y=Math.ceil(e),this.callRender(k.setPos,{x:t,y:e}))}setSize(t,e,i,s){t/=this.stageScaleX,e/=this.stageScaleY,i/=this.stageScaleX,s/=this.stageScaleY,this.owner instanceof Laya.Sprite&&(this.owner.anchorX=0,this.owner.anchorY=0,this.owner.scaleX=1,this.owner.scaleY=1,this.owner.x=Math.ceil(t),this.owner.y=Math.ceil(e),this.owner.width=Math.ceil(i),this.owner.height=Math.ceil(s),this.callRender(k.setPos,{x:t,y:e}),this.callRender(k.setSize,{width:i,height:s}))}setScale(t,e,i,s){i/=this.stageScaleX,s/=this.stageScaleY,this.owner instanceof Laya.Sprite&&(this.owner.anchorX=0,this.owner.anchorY=0,this.owner.width=i,this.owner.height=s,this.callRender(k.setSize,{width:i,height:s}))}setRota(t){this.owner instanceof Laya.Sprite&&(this.owner.anchorX=.5,this.owner.anchorY=.5,this.owner.rotation=t,this.callRender(k.setRota,{rotation:t}))}setAnchor(t,e){this.owner,Laya.Sprite}get stageScaleX(){return Laya.stage.transform.a/Laya.Browser.pixelRatio}get stageScaleY(){return Laya.stage.transform.d/Laya.Browser.pixelRatio}}class I{constructor(){e(this,"camera"),e(this,"type"),e(this,"_caller"),e(this,"_listener"),e(this,"currenTrack"),e(this,"currenClip"),e(this,"currenNode"),e(this,"controlSet",{isPos:!0,isSize:!0,isScale:!0,isRota:!0})}init(t,e,i){this.camera=t,this.type=i}setOnClick(t,e){this._caller=t,this._listener=e}onEnter(t,e){return this.currenTrack=t,this.currenClip=e,this.currenNode}onExit(t,e){this.currenTrack=null,this.currenClip=null}onAddTrackLayer(t){}onClick(t){null==this.currenTrack||1!=this.currenTrack.isLock?null!=this._listener&&this._listener.call(this._caller,t,this):this._listener.call(this._caller,null,null)}onUpdate(t,e){}onControlData(t,e){if(null!=this.currenClip)switch(t){case k.setPos:this.currenClip.transform.x=e.x,this.currenClip.transform.y=e.y;break;case k.setSize:this.currenClip.transform.width=e.width,this.currenClip.transform.height=e.height;break;case k.setScale:this.currenClip.transform.scaleX=e.scaleX,this.currenClip.transform.scaleY=e.scaleY;break;case k.setRota:this.currenClip.transform.rotation=e.rotation}}setTransformByClipData(t,e){e.transform.x>=0&&(t.x=e.transform.x),e.transform.y>=0&&(t.y=e.transform.y),e.transform.width>=0?t.width=e.transform.width:t instanceof Laya.Text&&(t.width=t.textWidth),e.transform.height>=0?t.height=e.transform.height:t instanceof Laya.Text&&(t.height=t.textHeight),0!=e.transform.scaleX&&(t.scaleX=e.transform.scaleX),0!=e.transform.scaleY&&(t.scaleY=e.transform.scaleY),t.rotation=e.transform.rotation}clear(){this._caller=null,this._listener=null,this.currenTrack=null,this.currenClip=null,this.currenNode=null}}class Y extends Laya.Sprite{constructor(){super(),e(this,"norm"),e(this,"sing"),e(this,"singMask"),e(this,"maskBox"),e(this,"enableFadein",!1),e(this,"progress",-1),e(this,"oldtext",null),this.norm=new Laya.Text,this.norm.mouseEnabled=!1,this.addChild(this.norm),this.sing=new Laya.Text,this.sing.mouseEnabled=!1,this.addChild(this.sing),this.maskBox=new Laya.Rectangle,this.singMask=new Laya.Sprite,this.singMask.graphics.drawRect(0,0,1,1,"#FFFFFF"),this.singMask.mouseEnabled=!1}initKaraoke(t,e,i,s,n){this.setTextStyle(this.norm,t,e,n),this.setTextStyle(this.sing,i,s,n),this.sing.mask=this.singMask,this.singProgress=0}updateParentPos(){null!=this.parent&&this.parent instanceof Laya.Sprite&&("right"==this.norm.align?(this.norm.x=this.parent.width-this.norm.textWidth,this.norm.y=this.parent.height-this.norm.textHeight):"left"==this.norm.align&&(this.norm.x=-this.maskBox.x,this.norm.y=-this.maskBox.y),this.sing.x=this.norm.x,this.sing.y=this.norm.y)}set text(t){null==t&&(t=""),this.oldtext!=t&&(this.oldtext=t,1==this.enableFadein?this.norm.text!=t&&(""!=t?(this.norm.alpha=.1,this.sing.visible=!0,Laya.Tween.to(this.norm,{alpha:1},300),this.setText(t)):(this.sing.visible=!1,this.norm.alpha=.5,Laya.Tween.to(this.norm,{alpha:0},300,null,Laya.Handler.create(this,(()=>{0==this.norm.alpha&&this.setText(t)}))))):this.setText(t))}setText(t){this.norm.text=t,this.sing.text=t,this.maskBox.x=-(this.norm.stroke+5),this.maskBox.y=-(this.norm.stroke+5),this.maskBox.width=this.norm.textWidth+this.norm.stroke,this.maskBox.height=this.norm.textHeight+2*this.norm.stroke+10,this.updateParentPos(),this.singMask.x=this.maskBox.x,this.singMask.y=this.maskBox.y,this.singMask.scaleX=this.maskBox.width,this.singMask.scaleY=this.maskBox.height,this.singMask.scaleX=0}get text(){return this.norm.text}set singProgress(t){this.progress!=t&&(this.progress=t,this.singMask.scaleX=Math.max(0,this.maskBox.width*t))}set letterSpacing(t){this.norm.letterSpacing=t,this.sing.letterSpacing=t}set fontSize(t){this.norm.fontSize=t,this.sing.fontSize=t}set font(t){this.norm.font=t,this.sing.font=t}set bold(t){this.norm.bold=t,this.sing.bold=t}set stroke(t){this.norm.stroke=t,this.sing.stroke=t}setTextStyle(t,e,i,s){t.color=e,t.strokeColor=i,t.align=s,t.wordWrap=!1}}class z extends I{constructor(){super(...arguments),e(this,"txtdic",{}),e(this,"letterSpacing",15),e(this,"stroke",10)}onEnter(t,e){super.onEnter(t,e);let i=this.getNode(0);return i.initKaraoke("#FFFFFF","#0c0c0c","#2f39d9","#ffffff","left"),i.width=Laya.stage.width,i.mouseEnabled=!0,i.text=e.text.content,i.x=125,i.y=809,i.width=1690,i.height=200,this.setTransformByClipData(i,e),this.currenTrack=t,this.currenClip=e,this.currenNode=i,this.currenNode}onExit(t,e){super.onExit(t,e);let i=this.getNode(0);null!=i.parent&&(i.mouseEnabled=!1,i.parent.removeChild(i)),this.currenTrack=null,this.currenClip=null,this.currenNode=null}onUpdate(){}getNode(t){let e=this.txtdic[t];return null==e&&(e=new Y,e.fontSize=70,e.font="Microsoft YaHei",e.bold=!0,e.letterSpacing=this.letterSpacing,e.stroke=this.stroke,e.mouseEnabled=!1,this.txtdic[t]=e),e}onControlData(t,e){super.onControlData(t,e),this.currenClip}}const X=class{constructor(){e(this,"_shaderValue"),e(this,"SHADER_ID",0),this.SHADER_ID=++X._uniqueIDCounter,this.initShader()}initShader(){this._shaderValue=new Laya.Value2D(this.SHADER_ID,this.SHADER_ID),this._shaderValue.shader=new Laya.Shader2X(this.shaderVS,this.shaderPS,this.SHADER_ID)}get isReady(){return!0}get shaderValue(){return this._shaderValue}get shaderVS(){return X.VS}get shaderPS(){return X.PS}};let O=X;e(O,"VS","\n        attribute vec4 posuv;\n        attribute vec4 attribColor;\n        attribute vec4 attribFlags;\n        attribute vec4 clipDir;\n        attribute vec2 clipRect;\n        uniform vec4 clipMatDir;\n        uniform vec2 clipMatPos;\n        varying vec2 cliped;\n        uniform vec2 size;\n        uniform vec2 clipOff;\n        #ifdef WORLDMAT\n            uniform mat4 mmat;\n        #endif\n        #ifdef MVP3D\n            uniform mat4 u_MvpMatrix;\n        #endif\n        varying vec4 v_Texcoord;\n        varying vec4 v_color;\n        varying float v_useTex;\n        void main() {\n            vec4 pos = vec4(posuv.xy,0.,1.);\n            #ifdef WORLDMAT\n                pos=mmat*pos;\n            #endif\n            vec4 pos1  =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,0.,1.0);\n            #ifdef MVP3D\n                gl_Position=u_MvpMatrix*pos1;\n            #else\n                gl_Position=pos1;\n            #endif\n            v_Texcoord.xy = posuv.zw;\n            v_Texcoord.z = attribColor.a/255.0;\n            v_color = attribColor/255.0;\n            v_color.xyz*=v_color.w;\n            v_useTex = attribFlags.r/255.0;\n            float clipw = length(clipMatDir.xy);\n            float cliph = length(clipMatDir.zw);\n            vec2 clpos = clipMatPos.xy;\n            #ifdef WORLDMAT\n            if(clipOff[0]>0.0){\n                clpos.x+=mmat[3].x;\n                clpos.y+=mmat[3].y;\n            }\n            #endif\n            vec2 clippos = pos.xy - clpos;\n\n            if(clipw>20000. && cliph>20000.)\n                cliped = vec2(0.5,0.5);\n            else {\n                cliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\n            }\n        }\n    "),e(O,"PS","\n        precision mediump float;\n        varying vec4 v_color;\n        uniform sampler2D texture;\n\n        varying vec4 v_Texcoord;\n\n        void main(){\n            gl_FragColor = texture2D(texture, v_Texcoord.xy);\n        }\n    "),e(O,"_uniqueIDCounter",9999);const V=class extends Laya.Sprite{constructor(){super(),e(this,"customShader"),e(this,"tex"),e(this,"videoTexture"),this.init()}init(){this.defaultMaterial(),this.customRenderEnable=!0,this.videoTexture=new Laya.Texture2D,this.tex=new Laya.Texture}defaultMaterial(){this.customShader=V.default||new O}setShader(t){this.customShader=t,null==t&&this.defaultMaterial()}setImage(t){this.tex.load(t)}setVideo(t){this.videoTexture.video=t,null!=t&&this.tex.setTexture2D(this.videoTexture)}customRender(t,e,i){t&&this.tex&&(this.videoTexture.video&&this.videoTexture.enableVideo&&this.videoTexture.updateVideoData(),this.width>0&&this.height>0&&null!=this.customShader&&1==this.customShader.isReady&&t.drawTarget(this.tex,e-this.pivotX,i-this.pivotY,this.width,this.height,null,this.customShader.shaderValue))}};let B=V;e(B,"SHADER_ID",9999),e(B,"default");class F extends I{constructor(){super(...arguments),e(this,"quad")}onEnter(t,e){var i,s;super.onEnter(t,e);let n=this.getNode();if(n.mouseEnabled=!0,null!=e.playMedia&&e.type==x.Video){let t=e.playMedia.getMediaElement();n.setVideo(t)}else e.type==x.Image&&n.setImage(e.mediaFilePath);return e.transform.width>0?n.width=e.transform.width:(null==(i=n.texture)?void 0:i.width)>0?n.width=n.texture.width:n.width=Laya.stage.width,e.transform.height>0?n.height=e.transform.height:(null==(s=n.texture)?void 0:s.height)>0?n.height=n.texture.height:n.height=Laya.stage.height,e.transform.x>=0?n.x=e.transform.x:n.x=(Laya.stage.width-n.width)/2,e.transform.y>=0?n.y=e.transform.y:n.y=(Laya.stage.height-n.height)/2,0!=e.transform.scaleX&&(n.scaleX=e.transform.scaleX),0!=e.transform.scaleY&&(n.scaleY=e.transform.scaleY),n.rotation=e.transform.rotation,this.quad=n,this.currenTrack=t,this.currenClip=e,this.currenNode}onExit(t,e){super.onExit(t,e);let i=this.getNode();null!=i.parent&&(i.setVideo(null),i.setImage(null),i.mouseEnabled=!1,i.parent.removeChild(i)),this.currenTrack=null,this.currenClip=null}onUpdate(){}getNode(){return null==this.currenNode&&(this.currenNode=new B,this.currenNode.on(Laya.Event.MOUSE_DOWN,this,this.onClick)),this.currenNode.scaleX=1,this.currenNode.scaleY=1,this.currenNode}onControlData(t,e){super.onControlData(t,e),this.currenClip}release(){null!=this.currenNode&&(this.currenNode.loadImage(null),this.currenNode.mouseEnabled=!1,this.currenNode.removeSelf(),this.currenNode.off(Laya.Event.MOUSE_DOWN,this,this.onClick),this.currenNode=null),super.clear()}}class Z extends Laya.MeshSprite3D{constructor(){super(Laya.PrimitiveMesh.createQuad(1,1)),e(this,"track"),e(this,"videoTexture"),e(this,"videoMaterial"),e(this,"r",new Laya.Vector3(0,.1,0)),e(this,"debug",!1),this.videoTexture=new Laya.VideoTexture,this.videoMaterial=new Laya.UnlitMaterial,this.videoMaterial.name="videoMaterial",this.videoMaterial.cull=Laya.RenderState.CULL_NONE,this.videoMaterial.albedoTexture=this.videoTexture,this.meshRenderer.sharedMaterial=this.videoMaterial,this.debug&&this.transform.rotate(new Laya.Vector3(0,45,0),!0,!1)}setVideo(t){this.videoTexture.video=t}defaultMaterial(){this.meshRenderer.sharedMaterial=this.videoMaterial}spreadScreen(t){let e=t.nearPlane+t.transform.position.z,i=Math.tan(t.fieldOfView*_.Deg2Rad*.5)*e*2,s=1;this.debug&&(s=.5),this.transform.localScale=new Laya.Vector3(i*t.aspectRatio*s,i*s,1)}updateIndexZ(t){if(null!=this.track){t=-.01*(t+.01);let e=this.transform.position;this.debug&&(t*=20,e.x=t),e.z=t,this.transform.position=e}}onUpdate(){}removeForParent(){null!=this.parent&&this.parent.removeChild(this)}clear(){this.track=null}}class G extends I{constructor(){super(...arguments),e(this,"quad")}onEnter(t,e){super.onEnter(t,e);let i=this.getQuad();if(i.defaultMaterial(),i.track=t,null!=e.playMedia&&e.type==x.Video){let t=e.playMedia.getMediaElement();i.setVideo(t)}return this.currenTrack=t,this.currenClip=e,null}onExit(t,e){super.onExit(t,e);let i=this.getQuad();null!=i.parent&&(null!==i.parent&&(i.setVideo(null),i.removeForParent()),i.track=null),this.currenTrack=null,this.currenClip=null}onUpdate(){this.quad.spreadScreen(this.camera),this.quad.onUpdate()}getQuad(){return null==this.quad&&(this.quad=new Z),this.quad}}class W extends I{constructor(){super(),e(this,"container"),e(this,"txtdic",{}),e(this,"letterSpacing",20),e(this,"stroke",10),e(this,"nodeTime",null),null==this.container&&(this.container=new Laya.Sprite),this.controlSet.isRota=!1}onEnter(t,e){super.onEnter(t,e);let i=this.getNode(0);i.initKaraoke("#FFFFFF","#0c0c0c","#2f39d9","#ffffff","left"),i.enableFadein=!0,i.width=Laya.stage.width;let s=this.getNode(1);return s.enableFadein=!0,s.initKaraoke("#FFFFFF","#0c0c0c","#2f39d9","#ffffff","right"),s.width=Laya.stage.width,this.container.addChild(i),this.container.addChild(s),this.container.x=125,this.container.y=709,this.container.width=1625,this.container.height=298,this.setTransformByClipData(this.container,e),this.currenTrack=t,this.currenClip=e,this.currenNode=this.container,this.currenNode.mouseEnabled=!0,this.currenNode.on(Laya.Event.MOUSE_DOWN,this,this.onClick),this.currenNode}onExit(t,e){super.onExit(t,e),this.container&&this.container.parent&&this.container.removeSelf();let i=this.getNode(0),s=this.getNode(1);i.text="",s.text="",this.currenTrack=null,this.currenClip=null}onUpdate(t,e){if(null==this.currenClip)return;let i=this.currenClip.getMediaFile(),s=this.getNode(0),n=this.getNode(1);if(t-=(this.currenClip.time.start-this.currenClip.time.startCut)/1e3,null==i||null==i.lrcParse)return s.text="",void(n.text="");let r=i.lrcParse.getPlayTimeLyric(t);null!=r&&1==r.update?r.line%2==0?(s.text=r.lyric,s.singProgress=r.processNum/100,n.text=r.lyricNext,n.singProgress=0):(s.text=r.lyricNext,s.singProgress=0,n.text=r.lyric,n.singProgress=r.processNum/100):(s.text="",n.text="")}getNode(t){let e=this.txtdic[t];return null==e&&(e=new Y,e.fontSize=125,e.font="极影毁片圆",e.bold=!0,e.letterSpacing=this.letterSpacing,e.stroke=this.stroke,e.mouseEnabled=!1,this.txtdic[t]=e),e}onControlData(t,e){super.onControlData(t,e),null!=this.currenClip&&this.container}}const j=class{constructor(){e(this,"cls",null),e(this,"camera"),e(this,"scene3D"),e(this,"videoquadlist",[])}initRender(t,e){null==this.cls&&(this.cls={},this.camera=t,this.scene3D=e,this.addRender(x.Text,z),this.addRender(x.Karaoke,W),this.addRender(x.Video,F),this.addRender(x.Image,F))}addRender(t,e){this.cls[t]=e}hasRenderSupport(t){return null!=this.cls[t]}enterRender(t,e){let i=t.uuid+"/"+e.uuid,s=j.renders[i];if(null==s){if(s=this.getRender(t.type),null==s)return null;if(s.onEnter(t,e),j.renders[i]=s,s instanceof G){-1==this.videoquadlist.indexOf(s)&&(this.videoquadlist.push(s),this.updateVideoIndexZ())}}return s}exitRender(t,e){let i=t.uuid+"/"+e.uuid,s=j.renders[i];if(null!=s&&(s.onExit(t,e),this.recycleRender(s),delete j.renders[i],s instanceof G)){let t=this.videoquadlist.indexOf(s);-1!=t&&(this.videoquadlist.splice(t,1),this.updateVideoIndexZ())}return s}onUpdate(t,e){let i=j.renders;for(const s in i){i[s].onUpdate(t,e)}}clear(){let t=j.renders;for(const e in t){const i=t[e];this.recycleRender(i)}this.videoquadlist.length=0}updateVideoIndexZ(){this.videoquadlist.sort(this.sortQuad);let t=0;for(let e=0;e<this.videoquadlist.length;e++){const i=this.videoquadlist[e].quad;null!=i.track&&null!=i.parent&&(i.updateIndexZ(t),t++)}}sortQuad(t,e){if(t.currenTrack==e.currenTrack){let i=-1,s=-1;return t.currenTrack&&(i=t.currenClip.time.start),e.currenTrack&&(s=e.currenClip.time.start),s-i}{let i=-1,s=-1;return t.currenTrack&&(i=t.currenTrack.indexZ),e.currenTrack&&(s=e.currenTrack.indexZ),i-s}}getRender(t){let e=j.pool[t],i=null;if(null!=e&&e.length>0&&(i=e.shift()),null==i){let e=this.cls[t];if(null==e)return null;i=new e,i instanceof G?i.init(this.camera,this.scene3D,t):i.init(this.camera,null,t)}return i}recycleRender(t){let e=j.pool[t.type];if(null==e)e=[t];else{-1==e.indexOf(t)&&e.push(t)}j.pool[t.type]=e}};let U=j;e(U,"pool",{}),e(U,"renders",{});class H{constructor(){e(this,"root"),e(this,"isSortChange",!1),e(this,"pool",[]),e(this,"maps",{}),e(this,"list",[])}addChildToTrackLayer(t,e){if(null!=t&&null!=e&&null!=e.currenNode){let i=this.getLayer(t);if(i.addChild(e.currenNode),e.onAddTrackLayer(i),1==this.isSortChange){this.isSortChange=!1,this.list.sort(this.sortLayerCompare);for(let t=0;t<this.list.length;t++){const e=this.list[t];this.root.addChild(e.layer)}}}}clearAllTrackLayer(){for(let t=0;t<this.list.length;t++){const e=this.list[t];e.layer.removeChildren(),this.pool.push(e.layer)}this.list.length=0,this.maps={}}getLayer(t){let e=this.maps[t.uuid];if(null!=e)return e.layer;let i=null;return i=this.pool.length>0?this.pool.shift():new Laya.Sprite,e={track:t,layer:i},this.maps[t.uuid]=e,this.list.push(e),this.isSortChange=!0,i}recycleLayer(t){let e=this.maps[t.uuid];if(null==e)return;let i=this.pool.indexOf(e.layer);-1==i&&(this.pool.push(e.layer),i=this.list.indexOf(e),-1!=i&&this.list.splice(i,1)),delete this.maps[t.uuid]}sortLayerCompare(t,e){return e.track.indexZ-t.track.indexZ}}var Q=(t=>(t.fadeIn="fadeIn",t))(Q||{});class J{constructor(){e(this,"type"),e(this,"startTime"),e(this,"endTime"),e(this,"progress"),e(this,"isEnter"),e(this,"render")}onEnter(t){}enterRender(t){this.render=t,null!=this.render&&this.onEnterRender()}onEnterRender(){}onUpdateTimeline(t){}onProgress(t){}exitRender(){null!=this.render&&this.onExitRender(),this.render=null}onExitRender(){}onExit(t){}}class q extends O{constructor(){super(),e(this,"_noiseTexture"),this.threshold=0,this.loadNoise()}loadNoise(){Laya.loader.load("./assets/images/shader/noise001.png",new Laya.Handler(this,(t=>{this.noiseTexture=t})))}get isReady(){return null!=this.noiseTexture}set threshold(t){this.shaderValue&&(this.shaderValue.u_threshold=t)}set noiseTexture(t){this._noiseTexture=t,this.shaderValue&&(this.shaderValue.u_noise=t.getGLSource())}get noiseTexture(){return this._noiseTexture}get shaderVS(){return O.VS}get shaderPS(){return"\n        \n        precision mediump float;\n\n        varying vec4 v_color;\n        varying vec4 v_Texcoord;\n        uniform sampler2D texture;\n     \n        uniform sampler2D u_noise;\n        uniform float u_threshold;\n\n\n        void main()\n        {\n\n            // 获取原始图像的颜色值\n            vec4 color = texture2D(texture, v_Texcoord.xy);\n\n            // 获取噪声纹理的颜色值\n            vec4 noiseColor = texture2D(u_noise, v_Texcoord.xy);\n\n\n            // 计算溶解度\n            float dissolve = (noiseColor.r + noiseColor.g + noiseColor.b) / 3.0;\n\n            //小于的地方透明化\n            if (dissolve > u_threshold) {\n                discard;\n            }\n\n            // 计算边缘颜色\n            vec3 edgeColor = vec3(1.0, 0.5, 0.0);\n\n            // 计算距离边缘的距离\n            float edgeWidth = 0.01;\n\n            //填充边缘颜色\n            if(dissolve - edgeWidth > u_threshold){\n                color = vec4(edgeColor,1.0);\n            }\n\n            gl_FragColor = color;\n\n\n        }\n        \n        "}}const K=class extends Laya.UnlitMaterial{constructor(){super(),1!=K._initShader&&(K._initShader=!0,this.initShader()),this.setShaderName(K.ShaderName),this.threshold=0,this.loadNoise()}loadNoise(){Laya.loader.load("./assets/images/shader/noise001.png",new Laya.Handler(this,(t=>{this.noiseTexture=t})))}get isReady(){return null!=this.noiseTexture}set noiseTexture(t){this._shaderValues.setTexture(K.NOISE,t)}get noiseTexture(){return this._shaderValues.getTexture(K.NOISE)}set threshold(t){this._shaderValues.setNumber(K.THRESHOLD,t)}initShader(){var t={a_Position:Laya.VertexMesh.MESH_POSITION0,a_Normal:Laya.VertexMesh.MESH_NORMAL0,a_Texcoord:Laya.VertexMesh.MESH_TEXTURECOORDINATE0},e={u_MvpMatrix:Laya.Shader3D.PERIOD_SPRITE,u_WorldMat:Laya.Shader3D.PERIOD_SPRITE,u_AlbedoTexture:Laya.Shader3D.PERIOD_MATERIAL,u_noise:Laya.Shader3D.PERIOD_MATERIAL,u_threshold:Laya.Shader3D.PERIOD_MATERIAL},i=Laya.Shader3D.add(K.ShaderName),s=new Laya.SubShader(t,e);i.addSubShader(s),s.addShaderPass('\n        #include "Lighting.glsl"; \n        attribute vec4 a_Position;\n        attribute vec2 a_Texcoord;\n        uniform mat4 u_MvpMatrix;\n        uniform mat4 u_WorldMat;\n        attribute vec3 a_Normal;\n        varying vec3 v_Normal;\n        varying vec2 v_Texcoord;\n\n        void main()\n        {\n        gl_Position = u_MvpMatrix * a_Position;\n        mat3 worldMat=mat3(u_WorldMat);\n        v_Normal=worldMat*a_Normal;\n        v_Texcoord=a_Texcoord;\n        gl_Position=remapGLPositionZ(gl_Position); \n        }',"\n        #ifdef FSHIGHPRECISION\n        precision highp float;\n        #else\n        precision mediump float;\n        #endif\n        varying vec3 v_Normal;\n        varying vec2 v_Texcoord;\n        uniform sampler2D u_AlbedoTexture;\n        uniform sampler2D u_noise;\n        uniform float u_threshold;\n        void main()\n        {\n\n        // 获取原始图像的颜色值\n        vec4 color = texture2D(u_AlbedoTexture, v_Texcoord);\n\n        // 获取噪声纹理的颜色值\n        vec4 noiseColor = texture2D(u_noise, v_Texcoord);\n\n\n        // 计算溶解度\n        float dissolve = (noiseColor.r + noiseColor.g + noiseColor.b) / 3.0;\n\n        //小于的地方透明化\n        if (dissolve > u_threshold) {\n            discard;\n        }\n\n          // 计算边缘颜色\n          vec3 edgeColor = vec3(1.0, 0.5, 0.0);\n      \n          // 计算距离边缘的距离\n          float edgeWidth = 0.01;\n\n          //填充边缘颜色\n          if(dissolve - edgeWidth > u_threshold){\n            color = vec4(edgeColor,1.0);\n          }\n\n        gl_FragColor = color;\n\n\n        }")}};let $=K;e($,"THRESHOLD",Laya.Shader3D.propertyNameToID("u_threshold")),e($,"NOISE",Laya.Shader3D.propertyNameToID("u_noise")),e($,"_initShader",!1),e($,"ShaderName","MaterialDissolve");class tt extends J{constructor(){super(),e(this,"material"),e(this,"dissolve"),this.material=new $,this.dissolve=new q}onEnter(t){this.startTime=t.time.start,this.endTime=t.time.start+t.time.overIn}onEnterRender(){if(this.render instanceof G){let t=this.render.quad,e=t.meshRenderer.sharedMaterial,i=e.cull,s=e.albedoTexture;t.meshRenderer.sharedMaterial=this.material,this.material.cull=i,this.material.albedoTexture=s}else this.render instanceof F&&this.render.quad.setShader(this.dissolve)}onProgress(t){this.render instanceof G?(t<1&&1!=this.material.isReady&&(t=0),this.material.threshold=t):this.render instanceof F&&(this.dissolve.threshold=t)}onExitRender(){(this.render instanceof G||this.render instanceof F)&&this.render.quad.defaultMaterial(),this.material.albedoTexture=null}}class et{constructor(){e(this,"cls",{}),e(this,"pool",{})}initScript(){this.addClass(Q.fadeIn,tt)}addClass(t,e){this.cls[t]=e}enterScript(t,e,i){let s=null;e.time.overIn>0&&(s=this.creatScript(Q.fadeIn),s=e.addScript(s),s.enterRender(i))}exitScript(t,e){let i=null;e.time.overIn>0&&(i=e.getScript(Q.fadeIn),null!=i&&(i.exitRender(),e.removeScript(i))),null!=i&&this.recycleScript(i)}creatScript(t){let e=this.pool[t],i=null;if(null!=e&&e.length>0&&(i=e.shift()),null==i){let e=this.cls[t];if(null==e)return null;i=new e,i.type=t}return i}recycleScript(t){if(null==t)return;t.isEnter=!1;let e=this.pool[t.type];if(null==e)e=[t];else{-1==e.indexOf(t)&&e.push(t)}this.pool[t.type]=e}}class it extends Laya.Sprite{constructor(){super(...arguments),e(this,"scene2D"),e(this,"scene3D"),e(this,"camera"),e(this,"directionalLight"),e(this,"imageBg"),e(this,"logo"),e(this,"objectlist",{}),e(this,"selectData"),e(this,"trackCollects"),e(this,"scriptCollects"),e(this,"trackLayers")}initEvent(){D.on(w.TF_SetBackgroundImage,this,this.onSetBackgroundImage),D.on(w.TF_ClipEnterTimeline,this,this.onClipEnterTimeline),D.on(w.TF_ClipExitTimeline,this,this.onClipExitTimeline),D.on(w.TF_SELECT_PICK_CLIP,this,this.onSelectPickClip),D.on(w.TF_UPDATE_TIMELINE,this,this.onUpdateTimeline)}initScene(){this.scene3D=this.addChild(new Laya.Scene3D),this.camera=this.scene3D.addChild(new Laya.Camera),this.camera.clearFlag=Laya.CameraClearFlags.DepthOnly,this.camera.nearPlane=.001,this.camera.farPlane=1e5,this.camera.transform.translate(new Laya.Vector3(0,0,20)),this.directionalLight=this.scene3D.addChild(new Laya.DirectionLight),this.directionalLight.transform.position=new Laya.Vector3(0,0,0),this.directionalLight.transform.rotationEuler=new Laya.Vector3(-50,180,0),this.directionalLight.color=new Laya.Vector3(1,1,1)}initObject(){this.imageBg=new Laya.Sprite,this.imageBg.alignPivot=!0,this.imageBg.width=Laya.stage.width,this.imageBg.height=Laya.stage.height,this.imageBg.on(Laya.Event.MOUSE_DOWN,this,this.onClickHanler),this.addChild(this.imageBg),this.scene3D=this.addChild(new Laya.Scene3D),this.camera=this.scene3D.addChild(new Laya.Camera),this.camera.clearFlag=Laya.CameraClearFlags.DepthOnly,this.camera.nearPlane=.001,this.camera.farPlane=1e5,this.camera.transform.translate(new Laya.Vector3(0,0,20)),this.directionalLight=this.scene3D.addChild(new Laya.DirectionLight),this.directionalLight.transform.position=new Laya.Vector3(0,0,0),this.directionalLight.transform.rotationEuler=new Laya.Vector3(-50,180,0),this.directionalLight.color=new Laya.Vector3(1,1,1),this.scene2D=new Laya.Sprite,this.addChild(this.scene2D),this.trackLayers=new H,this.trackLayers.root=this.scene2D,this.trackCollects=new U,this.trackCollects.initRender(this.camera,this.scene3D),this.scriptCollects=new et,this.scriptCollects.initScript()}onUpdateTimeline(t,e){this.trackCollects.onUpdate(t,e)}onClickHanler(t,e){var i;if(null==t)return this.selectRenderNode(null,null,null),void D.sendlibmessage(w.TM_SCENE_PICK_CLIP,null,null);t.target;this.selectData;let s=this.selectRenderNode(t.target,e,{x:t.stageX,y:t.stageY});null!=s&&null!=(null==(i=s.render)?void 0:i.currenClip)?1!=s.render.currenClip.event.selected&&D.sendlibmessage(w.TM_SCENE_PICK_CLIP,s.render.currenTrack,s.render.currenClip):D.sendlibmessage(w.TM_SCENE_PICK_CLIP,null,null)}selectRenderNode(t,e,i){let s=null;return null!=t&&(t==this.imageBg?s=null:(s=this.objectlist[t.id],null==s&&(s=new A),s.render=e,s.setOwner(t),s.setMouse(i.x,i.y))),this.selectData=s,D.sendTomodule(w.TM_SCENE_SELECT_OBJECT,s),s}onSetBackgroundImage(t){this.imageBg.loadImage(t)}onClipEnterTimeline(t,e){if(1!=this.trackCollects.hasRenderSupport(t.type))return;let i=this.trackCollects.enterRender(t,e);null!=i&&null!=i.currenNode&&(this.trackLayers.addChildToTrackLayer(t,i),this.scriptCollects.enterScript(t,e,i),i.setOnClick(this,this.onClickHanler),1==e.event.selected&&null!=i.currenNode&&this.selectRenderNode(i.currenNode,i,{x:NaN,y:NaN}))}onClipExitTimeline(t,e){var i;if(1!=this.trackCollects.hasRenderSupport(t.type))return;let s=this.trackCollects.exitRender(t,e);null!=s&&(this.scriptCollects.exitScript(t,e),(null==(i=this.selectData)?void 0:i.render)==s&&this.selectRenderNode(null,null,null))}onSelectPickClip(t){let e=!1;if(null!=t){let i=U.renders;for(const s in i){const n=i[s];if(n.currenClip==t){e=!0,this.selectRenderNode(n.currenNode,n,{x:NaN,y:NaN});break}}}1!=e&&null!=this.selectData&&this.selectRenderNode(null,null,null)}}class st{static loadFont(t,e){if(null!=this.fontdic[t])return;let i=new FontFace(t,`url(${e})`);return this.fontdic[t]=i,i.loaded.then((t=>{if(document.fonts.add(t),null!=window.parent&&null!=window.parent.document&&window.parent.document.fonts.add(t),window.frames)for(let e=0;e<window.frames.length;e++){const i=window.frames[e];null!=i&&i.document.fonts.add(t)}})),i.load()}static delete(t){let e=this.fontdic[t];if(null!=e&&(delete this.fontdic[t],document.fonts.delete(e),null!=window.parent&&null!=window.parent.document&&window.parent.document.fonts.delete(e),window.frames))for(let i=0;i<window.frames.length;i++){const t=window.frames[i];null!=t&&t.document.fonts.delete(e)}}}e(st,"fontdic",{});class nt{constructor(){e(this,"isinitEngine",!1),e(this,"initComplete",null),e(this,"main")}onComplete(t){this.initComplete=t}async initEngine(){if(1==this.isinitEngine)return;this.isinitEngine=!0,D.sendlibmessage(w.initengine,{loading:!0,text:"启动引擎"}),await l();let t={width:1920,height:1080,scaleMode:Laya.Stage.SCALE_SHOWALL,screenMode:Laya.Stage.SCREEN_NONE,alignV:Laya.Stage.ALIGN_LEFT,alignH:Laya.Stage.ALIGN_TOP,stat:!1};0==Laya.Config.useWebGL2&&(Laya.Config.useWebGL2=!0);var e=new Laya.Config3D;null!=e&&(e.enableMultiLight=!1,e.isAlpha=!0),Laya.Config.preserveDrawingBuffer=!0,Laya.Config.isAlpha=!0,Laya3D.init(t.width,t.height,e,Laya.Handler.create(this,this.engineComplete)),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=t.scaleMode,Laya.stage.screenMode=t.screenMode,Laya.stage.alignV=t.alignV,Laya.stage.alignH=t.alignH,Laya.alertGlobalError(!0);let i=Laya.Browser.container;null!=i&&i.parentNode&&i.parentNode.removeChild(i),Laya.stage.frameRate=Laya.Stage.FRAME_FAST,Laya.stage.bgColor=null,Laya.stage.useRetinalCanvas=!0,D.on(w.TF_SetfullDesign,this,this.onSetfullDesign),Laya.stage.on(Laya.Event.RESIZE,this,this.onSceneResizeHandler)}engineComplete(){null!=this.initComplete&&(this.initComplete(),this.initComplete=null),D.sendlibmessage(w.initengine,{loading:!0,text:"启动场景"}),this.main=new it,Laya.stage.addChild(this.main),this.main.initEvent(),this.main.initScene(),this.main.initObject(),setTimeout((()=>{let t=Laya.Browser.mainCanvas.getCanvas();D.sendlibmessage(w.initengine,{loading:!1,complete:!0,mainCanvas:t})}),100),st.loadFont("极影毁片圆","./cdn/font/KTXP_Rounded2.woff2")}onSetfullDesign(t){Laya.stage.isfullDesign=t;let e=Laya.Browser.mainCanvas.getCanvas();e&&(e.style.display=t?"none":"block")}onSceneResizeHandler(t){D.sendTomodule(w.TM_SCENE_RESIZE)}}const rt=(t=>(g("data-v-1cfe3b7f"),t=t(),p(),t))((()=>d("div",{class:"div-contet"},null,-1))),ot=y(i({__name:"OfflineEngine",setup(t){let e,i,h=s(),l="OfflineEngine",g=s();function p(t){i=t,g.value.selectControl(i)}function m(){g.value.selectControl(i)}n((()=>{window.maininit=async()=>{window.maininit=null,e=new nt,e.onComplete(f),await e.initEngine()},window.onbeforeunload=function(){h.value.style.opacity="0.0"},D.on(w.TM_SCENE_SELECT_OBJECT,l,p),D.on(w.TM_SCENE_RESIZE,l,m)})),r((()=>{D.clearAll(l)}));const f=()=>{let t=h.value,e=Laya.Browser.mainCanvas.source;e.style.boxSizing="border-box",t.appendChild(e)};return(t,e)=>(o(),a(u,null,[d("div",{ref_key:"refRenderContainer",ref:h,class:"div-renderContainer"},[c(P,{ref_key:"refControl",ref:g},null,512)],512),rt],64))}}),[["__scopeId","data-v-1cfe3b7f"]]),at={class:"div-offscreen"};f(y(i({__name:"OffIndex",setup(t){n((()=>{D.initmainmessage(),D.sendlibmessage(w.initengine,{loading:!0,text:"准备中"})}));return(t,e)=>(o(),a("div",{class:"app-container",onDragover:e[0]||(e[0]=t=>{return(e=t).stopPropagation(),e.preventDefault(),void(e.dataTransfer.dropEffect="none");var e}),onContextmenu:e[1]||(e[1]=m((()=>{}),["prevent"]))},[d("div",at,[c(ot)])],32))}}),[["__scopeId","data-v-44c30c93"]])).mount("#app");
